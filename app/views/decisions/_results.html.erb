<span
  data-controller="decision-results"
  data-decision-results-url-value="<%= @decision.path %>/results.html"
  >
  <h2><%= @decision.is_finalized? ? "Final" : "Current" %> Results</h2>
  <p>
    <% unless @decision.is_finalized? %>
      <a data-action="click->decision-results#toggleResults" href="#"><% if @show_results %>Hide<% else %>Show<% end %> results</a>
    <% end %>
  </p>
  <span id="results" style="display:<% if @show_results %>inline<% else %>none<% end %>;">
    <p>
      Results are sorted first by approvals âœ…, then by stars â­, then by random digits ğŸ².
    </p>
    <table class="results-table">
      <thead>
        <tr>
          <th title="place"></th>
          <th title="option"></th>
          <th title="approvals">âœ…</th>
          <th title="stars">â­</th>
          <th title="random digits">ğŸ²</th>
        </tr>
      </thead>
      <tbody>
        <% @decision.results.each_with_index do |result, index| %>
          <tr style="<%= index == 0 ? 'box-shadow: inset 0 0 5px yellow;font-weight:bold;' : '' %>">
            <td><%= index + 1 %></td>
            <td><%= result.option_title %></td>
            <td style="opacity:<%= (result.approved_yes || 0) > 0 ? 1 : 0.4 %>;"><%= (result.approved_yes || 0) %></td>
            <td style="opacity:<%= (result.stars || 0) > 0 ? 1 : 0.4 %>;"><%= (result.stars || 0) %></td>
            <td style="opacity:0.4;font-size:0.8em;" title="<%= result.random_id %>"><%= "#{result.random_id}".slice(0, 3) + "..." %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <span data-decision-results-target="message">
    <%= @voter_count %> <%= @voter_verb_phrase %> voted on this decision.
    <% unless @decision.is_finalized? %>Recent as of <span data-decision-results-target="age"></span>. <a data-action="click->decision-results#refreshResults" href="#">Refresh results</a><% end %>
    </span>
  </span>
</span>